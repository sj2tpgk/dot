Emacs 27's new hook window-selection-change-functions can be used to update the cursor shape in CUI according to the evil states when switching between windows.
This helps me avoid accidentally inserting text like jjjjjji after using other-window.

    (defun change-cursor (&rest args)
      "Change cursor according to evil states in terminals."
      (unless (display-graphic-p)
        (send-string-to-terminal ;;           bar        block
          (if evil-insert-state-minor-mode "\033[6 q" "\033[2 q"))))
    
    (dolist (hook '(window-selection-change-functions evil-insert-state-entry-hook evil-normal-state-entry-hook))
      (add-hook hook 'change-cursor))
